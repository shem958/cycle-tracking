{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/shercy/cycle-tracking/src/app/components/CycleForm.js"],"sourcesContent":["\"use client\";\nimport { useEffect, useState, useCallback } from \"react\";\nimport { Calendar, Activity, Heart, Clock, Trash2, Pencil } from \"lucide-react\";\nimport { useAppContext } from \"../context/AppContext\";\nimport { useForm } from \"react-hook-form\";\n\nconst CycleForm = () => {\n  const { cycles, fetchCycles, token } = useAppContext();\n  const {\n    register,\n    handleSubmit,\n    reset,\n    setValue,\n    formState: { errors },\n  } = useForm();\n  const [isEditing, setIsEditing] = useState(false);\n  const [editId, setEditId] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [success, setSuccess] = useState(\"\");\n\n  // Predefined options\n  const moodOptions = [\"Happy\", \"Sad\", \"Anxious\", \"Irritable\", \"Calm\"];\n  const symptomOptions = [\n    \"Cramps\",\n    \"Fatigue\",\n    \"Headache\",\n    \"Bloating\",\n    \"Nausea\",\n  ];\n\n  const resetForm = useCallback(() => {\n    reset({ startDate: \"\", length: \"\", symptoms: [], mood: \"\" });\n    setIsEditing(false);\n    setEditId(null);\n    setError(\"\");\n    setSuccess(\"\");\n  }, [reset]);\n\n  const submitCycle = useCallback(\n    async (cycleData, method, id) => {\n      setLoading(true);\n      setError(\"\");\n      setSuccess(\"\");\n\n      try {\n        if (!token) {\n          throw new Error(\"Authentication token not found\");\n        }\n\n        const url = id\n          ? `http://localhost:8080/api/cycles/${id}`\n          : \"http://localhost:8080/api/cycles\";\n\n        const res = await fetch(url, {\n          method,\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify(cycleData),\n        });\n\n        if (!res.ok) {\n          const result = await res.json().catch(() => ({}));\n          throw new Error(\n            result.message || `HTTP ${res.status}: Failed to save cycle`\n          );\n        }\n\n        resetForm();\n        await fetchCycles(); // Ensure cycles are refreshed\n        setSuccess(\"Cycle saved successfully!\");\n\n        // Clear success message after 3 seconds\n        setTimeout(() => setSuccess(\"\"), 3000);\n      } catch (err) {\n        console.error(\"Submit error:\", err);\n        setError(err.message || \"Network error. Please try again.\");\n      } finally {\n        setLoading(false);\n      }\n    },\n    [fetchCycles, resetForm, token]\n  );\n\n  const onSubmit = async (data) => {\n    setError(\"\");\n    setSuccess(\"\");\n\n    // Validate data\n    if (!data.startDate) {\n      setError(\"Start date is required\");\n      return;\n    }\n\n    if (!data.length || data.length < 1 || data.length > 99) {\n      setError(\"Cycle length must be between 1 and 99 days\");\n      return;\n    }\n\n    const cycleData = {\n      startDate: data.startDate,\n      length: parseInt(data.length),\n      symptoms: Array.isArray(data.symptoms) ? data.symptoms.join(\",\") : \"\",\n      mood: data.mood || \"\",\n    };\n\n    await submitCycle(cycleData, isEditing ? \"PUT\" : \"POST\", editId);\n  };\n\n  const handleEdit = (cycle) => {\n    if (!cycle) return;\n\n    setValue(\"startDate\", cycle.startDate);\n    setValue(\"length\", cycle.length);\n    setValue(\"symptoms\", cycle.symptoms ? cycle.symptoms.split(\",\") : []);\n    setValue(\"mood\", cycle.mood || \"\");\n    setEditId(cycle.ID);\n    setIsEditing(true);\n    setError(\"\");\n    setSuccess(\"\");\n  };\n\n  const handleDelete = async (id) => {\n    if (!confirm(\"Are you sure you want to delete this entry?\")) return;\n\n    setLoading(true);\n    try {\n      if (!token) {\n        throw new Error(\"Authentication token not found\");\n      }\n\n      const res = await fetch(`http://localhost:8080/api/cycles/${id}`, {\n        method: \"DELETE\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      if (!res.ok) {\n        const result = await res.json().catch(() => ({}));\n        throw new Error(result.message || \"Failed to delete entry\");\n      }\n\n      await fetchCycles();\n      setSuccess(\"Entry deleted successfully!\");\n      setTimeout(() => setSuccess(\"\"), 3000);\n    } catch (err) {\n      console.error(\"Delete error:\", err);\n      setError(err.message || \"Failed to delete entry\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Auto-clear error messages after 5 seconds\n  useEffect(() => {\n    if (error) {\n      const timer = setTimeout(() => setError(\"\"), 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [error]);\n\n  return (\n    <div className=\"min-h-screen w-full bg-pink-50 dark:bg-gray-900 p-6\">\n      <div className=\"max-w-4xl mx-auto text-center mb-8\">\n        <h1 className=\"text-gray-700 dark:text-gray-200 text-xl\">\n          Track your cycles accurately and gain valuable health insights.\n        </h1>\n      </div>\n\n      <form\n        onSubmit={handleSubmit(onSubmit)}\n        className=\"max-w-4xl mx-auto p-8 rounded-3xl bg-[#1B2433] shadow-xl\"\n      >\n        <h2 className=\"text-3xl font-semibold mb-8 text-white text-center\">\n          {isEditing ? \"Edit Cycle\" : \"Cycle Journal\"}\n        </h2>\n\n        {/* Feedback messages */}\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded-lg\">\n            <p className=\"text-red-800 dark:text-red-200 text-sm\">{error}</p>\n          </div>\n        )}\n        {success && (\n          <div className=\"mb-4 p-3 bg-green-100 dark:bg-green-900/20 border border-green-300 dark:border-green-700 rounded-lg\">\n            <p className=\"text-green-800 dark:text-green-200 text-sm\">\n              {success}\n            </p>\n          </div>\n        )}\n\n        <div className=\"grid md:grid-cols-2 gap-8\">\n          <div className=\"space-y-6\">\n            <label className=\"block text-sm text-gray-300\">\n              <Calendar className=\"inline w-4 h-4 mr-2\" />\n              Start Date\n              <input\n                type=\"date\"\n                {...register(\"startDate\", {\n                  required: \"Start date is required\",\n                })}\n                className=\"w-full mt-2 px-4 py-3 rounded-xl bg-[#2A3441] text-gray-200 border border-gray-600 focus:border-pink-500 focus:outline-none\"\n                max={new Date().toISOString().split(\"T\")[0]} // Prevent future dates\n              />\n              {errors.startDate && (\n                <p className=\"text-red-400 text-sm mt-1\">\n                  {errors.startDate.message}\n                </p>\n              )}\n            </label>\n\n            <label className=\"block text-sm text-gray-300\">\n              <Clock className=\"inline w-4 h-4 mr-2\" />\n              Cycle Length (Days)\n              <input\n                type=\"number\"\n                {...register(\"length\", {\n                  required: \"Cycle length is required\",\n                  min: { value: 1, message: \"Minimum 1 day\" },\n                  max: { value: 99, message: \"Maximum 99 days\" },\n                })}\n                className=\"w-full mt-2 px-4 py-3 rounded-xl bg-[#2A3441] text-gray-200 border border-gray-600 focus:border-pink-500 focus:outline-none\"\n                min=\"1\"\n                max=\"99\"\n              />\n              {errors.length && (\n                <p className=\"text-red-400 text-sm mt-1\">\n                  {errors.length.message}\n                </p>\n              )}\n            </label>\n\n            <label className=\"block text-sm text-gray-300\">\n              <Heart className=\"inline w-4 h-4 mr-2\" />\n              Mood\n              <select\n                {...register(\"mood\")}\n                className=\"w-full mt-2 px-4 py-3 rounded-xl bg-[#2A3441] text-gray-200 border border-gray-600 focus:border-pink-500 focus:outline-none\"\n              >\n                <option value=\"\">Select mood</option>\n                {moodOptions.map((mood) => (\n                  <option key={mood} value={mood}>\n                    {mood}\n                  </option>\n                ))}\n              </select>\n            </label>\n          </div>\n\n          <label className=\"block text-sm text-gray-300\">\n            <Activity className=\"inline w-4 h-4 mr-2\" />\n            Symptoms\n            <div className=\"mt-2 space-y-2 max-h-40 overflow-y-auto\">\n              {symptomOptions.map((symptom) => (\n                <label\n                  key={symptom}\n                  className=\"flex items-center text-gray-300 hover:text-white\"\n                >\n                  <input\n                    type=\"checkbox\"\n                    value={symptom}\n                    {...register(\"symptoms\")}\n                    className=\"mr-2 text-pink-500 focus:ring-pink-500\"\n                  />\n                  {symptom}\n                </label>\n              ))}\n            </div>\n            {errors.symptoms && (\n              <p className=\"text-red-400 text-sm mt-1\">\n                {errors.symptoms.message}\n              </p>\n            )}\n          </label>\n        </div>\n\n        <div className=\"mt-8 flex justify-between items-center\">\n          <button\n            type=\"submit\"\n            className=\"px-8 py-3 rounded-xl bg-pink-500 hover:bg-pink-600 disabled:bg-pink-300 disabled:cursor-not-allowed text-white font-medium text-lg transition-colors\"\n            disabled={loading}\n          >\n            {loading\n              ? isEditing\n                ? \"Updating...\"\n                : \"Saving...\"\n              : isEditing\n              ? \"Update Entry\"\n              : \"Save Entry\"}\n          </button>\n\n          {isEditing && (\n            <button\n              type=\"button\"\n              onClick={resetForm}\n              className=\"text-sm text-gray-300 hover:text-white underline\"\n              disabled={loading}\n            >\n              Cancel Edit\n            </button>\n          )}\n        </div>\n      </form>\n\n      {/* Past Entries Section */}\n      <div className=\"max-w-4xl mx-auto mt-12\">\n        <h3 className=\"text-xl font-medium mb-4 text-gray-800 dark:text-white\">\n          Past Entries ({cycles.length})\n        </h3>\n\n        {cycles.length === 0 ? (\n          <div className=\"text-center py-12 bg-white dark:bg-[#2A3441] rounded-xl\">\n            <div className=\"text-6xl mb-4\">üìù</div>\n            <p className=\"text-gray-500 dark:text-gray-400\">No entries yet</p>\n            <p className=\"text-sm text-gray-400 dark:text-gray-500 mt-2\">\n              Your cycle entries will appear here after you save them\n            </p>\n          </div>\n        ) : (\n          <ul className=\"space-y-4\">\n            {cycles.map((entry) => (\n              <li\n                key={entry.ID}\n                className=\"bg-white dark:bg-[#2A3441] rounded-xl p-4 shadow flex justify-between items-center hover:shadow-lg transition-shadow\"\n              >\n                <div>\n                  <p className=\"text-gray-900 dark:text-gray-100 font-medium\">\n                    {new Date(entry.startDate).toLocaleDateString()} -{\" \"}\n                    {entry.length} days\n                  </p>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    <span className=\"font-medium\">Mood:</span>{\" \"}\n                    {entry.mood || \"Not specified\"} |\n                    <span className=\"font-medium ml-2\">Symptoms:</span>{\" \"}\n                    {entry.symptoms || \"None\"}\n                  </p>\n                </div>\n                <div className=\"flex gap-3\">\n                  <button\n                    onClick={() => handleEdit(entry)}\n                    className=\"text-blue-500 hover:text-blue-700 p-1 rounded transition-colors\"\n                    title=\"Edit\"\n                    disabled={loading}\n                  >\n                    <Pencil className=\"w-5 h-5\" />\n                  </button>\n                  <button\n                    onClick={() => handleDelete(entry.ID)}\n                    className=\"text-red-500 hover:text-red-700 p-1 rounded transition-colors\"\n                    title=\"Delete\"\n                    disabled={loading}\n                  >\n                    <Trash2 className=\"w-5 h-5\" />\n                  </button>\n                </div>\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CycleForm;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 637, "column": 0}, "map": {"version":3,"sources":["file:///home/shercy/cycle-tracking/src/app/components/ProtectedRoute.js"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppContext } from \"../context/AppContext\";\n\nexport default function ProtectedRoute({ children, allowedRoles }) {\n  const { user, token, isTokenExpired } = useAppContext();\n  const router = useRouter();\n  const [isLoading, setIsLoading] = useState(true);\n  const [isAuthorized, setIsAuthorized] = useState(false);\n\n  useEffect(() => {\n    const checkAuth = () => {\n      // No token means not authenticated\n      if (!token || isTokenExpired(token)) {\n        setIsAuthorized(false);\n        setIsLoading(false);\n        router.push(\"/login\");\n        return;\n      }\n\n      // Check role authorization if roles are specified\n      if (allowedRoles && user) {\n        if (!allowedRoles.includes(user.role)) {\n          setIsAuthorized(false);\n          setIsLoading(false);\n          router.push(\"/\"); // Redirect to home if role not allowed\n          return;\n        }\n      }\n\n      // If we have token and user passes role check\n      if (user) {\n        setIsAuthorized(true);\n        setIsLoading(false);\n      } else {\n        // Wait a bit more for user data to load\n        setTimeout(() => {\n          if (!user) {\n            setIsAuthorized(false);\n            setIsLoading(false);\n            router.push(\"/login\");\n          }\n        }, 1000);\n      }\n    };\n\n    checkAuth();\n  }, [token, user, allowedRoles, router, isTokenExpired]);\n\n  // Show loading spinner while checking authentication\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto\"></div>\n          <p className=\"mt-4 text-foreground/70\">Checking authentication...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Don't render children if not authorized\n  if (!isAuthorized) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-semibold text-foreground mb-2\">\n            Access Denied\n          </h2>\n          <p className=\"text-foreground/70\">\n            You don&apos;t have permission to access this page.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return children;\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAHA;;;;;AAKe,SAAS,eAAe,EAAE,QAAQ,EAAE,YAAY,EAAE;IAC/D,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,cAAc,EAAE,GAAG,CAAA,GAAA,mIAAA,CAAA,gBAAa,AAAD;IACpD,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,YAAY;YAChB,mCAAmC;YACnC,IAAI,CAAC,SAAS,eAAe,QAAQ;gBACnC,gBAAgB;gBAChB,aAAa;gBACb,OAAO,IAAI,CAAC;gBACZ;YACF;YAEA,kDAAkD;YAClD,IAAI,gBAAgB,MAAM;gBACxB,IAAI,CAAC,aAAa,QAAQ,CAAC,KAAK,IAAI,GAAG;oBACrC,gBAAgB;oBAChB,aAAa;oBACb,OAAO,IAAI,CAAC,MAAM,uCAAuC;oBACzD;gBACF;YACF;YAEA,8CAA8C;YAC9C,IAAI,MAAM;gBACR,gBAAgB;gBAChB,aAAa;YACf,OAAO;gBACL,wCAAwC;gBACxC,WAAW;oBACT,IAAI,CAAC,MAAM;wBACT,gBAAgB;wBAChB,aAAa;wBACb,OAAO,IAAI,CAAC;oBACd;gBACF,GAAG;YACL;QACF;QAEA;IACF,GAAG;QAAC;QAAO;QAAM;QAAc;QAAQ;KAAe;IAEtD,qDAAqD;IACrD,IAAI,WAAW;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBAAE,WAAU;kCAA0B;;;;;;;;;;;;;;;;;IAI/C;IAEA,0CAA0C;IAC1C,IAAI,CAAC,cAAc;QACjB,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA8C;;;;;;kCAG5D,8OAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;;;;;;IAM1C;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 772, "column": 0}, "map": {"version":3,"sources":["file:///home/shercy/cycle-tracking/src/app/cycles/page.js"],"sourcesContent":["\"use client\";\nimport CycleForm from \"@/app/components/CycleForm\";\nimport ProtectedRoute from \"@/app/components/ProtectedRoute\";\nimport { useAppContext } from \"@/app/context/AppContext\";\nimport { useEffect } from \"react\";\n\nexport default function CyclesPage() {\n  const { fetchCycles, token } = useAppContext();\n\n  // Ensure cycles are loaded when page mounts\n  useEffect(() => {\n    if (token) {\n      fetchCycles();\n    }\n  }, [token, fetchCycles]);\n\n  return (\n    <ProtectedRoute allowedRoles={[\"user\", \"doctor\", \"admin\"]}>\n      <div className=\"min-h-screen\">\n        <CycleForm />\n      </div>\n    </ProtectedRoute>\n  );\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AAJA;;;;;;AAMe,SAAS;IACtB,MAAM,EAAE,WAAW,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,mIAAA,CAAA,gBAAa,AAAD;IAE3C,4CAA4C;IAC5C,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,OAAO;YACT;QACF;IACF,GAAG;QAAC;QAAO;KAAY;IAEvB,qBACE,8OAAC,0IAAA,CAAA,UAAc;QAAC,cAAc;YAAC;YAAQ;YAAU;SAAQ;kBACvD,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,qIAAA,CAAA,UAAS;;;;;;;;;;;;;;;AAIlB","debugId":null}}]
}