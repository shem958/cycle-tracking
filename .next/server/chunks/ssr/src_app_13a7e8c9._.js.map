{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/shercy/cycle-tracking/src/app/components/ProtectedRoute.js"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppContext } from \"../context/AppContext\";\n\nexport default function ProtectedRoute({ children, allowedRoles }) {\n  const { user, token, isTokenExpired } = useAppContext();\n  const router = useRouter();\n  const [isLoading, setIsLoading] = useState(true);\n  const [isAuthorized, setIsAuthorized] = useState(false);\n\n  useEffect(() => {\n    const checkAuth = () => {\n      // No token means not authenticated\n      if (!token || isTokenExpired(token)) {\n        setIsAuthorized(false);\n        setIsLoading(false);\n        router.push(\"/login\");\n        return;\n      }\n\n      // Check role authorization if roles are specified\n      if (allowedRoles && user) {\n        if (!allowedRoles.includes(user.role)) {\n          setIsAuthorized(false);\n          setIsLoading(false);\n          router.push(\"/\"); // Redirect to home if role not allowed\n          return;\n        }\n      }\n\n      // If we have token and user passes role check\n      if (user) {\n        setIsAuthorized(true);\n        setIsLoading(false);\n      } else {\n        // Wait a bit more for user data to load\n        setTimeout(() => {\n          if (!user) {\n            setIsAuthorized(false);\n            setIsLoading(false);\n            router.push(\"/login\");\n          }\n        }, 1000);\n      }\n    };\n\n    checkAuth();\n  }, [token, user, allowedRoles, router, isTokenExpired]);\n\n  // Show loading spinner while checking authentication\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto\"></div>\n          <p className=\"mt-4 text-foreground/70\">Checking authentication...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Don't render children if not authorized\n  if (!isAuthorized) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-semibold text-foreground mb-2\">\n            Access Denied\n          </h2>\n          <p className=\"text-foreground/70\">\n            You don&apos;t have permission to access this page.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return children;\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAHA;;;;;AAKe,SAAS,eAAe,EAAE,QAAQ,EAAE,YAAY,EAAE;IAC/D,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,cAAc,EAAE,GAAG,CAAA,GAAA,mIAAA,CAAA,gBAAa,AAAD;IACpD,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,YAAY;YAChB,mCAAmC;YACnC,IAAI,CAAC,SAAS,eAAe,QAAQ;gBACnC,gBAAgB;gBAChB,aAAa;gBACb,OAAO,IAAI,CAAC;gBACZ;YACF;YAEA,kDAAkD;YAClD,IAAI,gBAAgB,MAAM;gBACxB,IAAI,CAAC,aAAa,QAAQ,CAAC,KAAK,IAAI,GAAG;oBACrC,gBAAgB;oBAChB,aAAa;oBACb,OAAO,IAAI,CAAC,MAAM,uCAAuC;oBACzD;gBACF;YACF;YAEA,8CAA8C;YAC9C,IAAI,MAAM;gBACR,gBAAgB;gBAChB,aAAa;YACf,OAAO;gBACL,wCAAwC;gBACxC,WAAW;oBACT,IAAI,CAAC,MAAM;wBACT,gBAAgB;wBAChB,aAAa;wBACb,OAAO,IAAI,CAAC;oBACd;gBACF,GAAG;YACL;QACF;QAEA;IACF,GAAG;QAAC;QAAO;QAAM;QAAc;QAAQ;KAAe;IAEtD,qDAAqD;IACrD,IAAI,WAAW;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBAAE,WAAU;kCAA0B;;;;;;;;;;;;;;;;;IAI/C;IAEA,0CAA0C;IAC1C,IAAI,CAAC,cAAc;QACjB,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA8C;;;;;;kCAG5D,8OAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;;;;;;IAM1C;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///home/shercy/cycle-tracking/src/app/pregnancy/page.js"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { useAppContext } from \"@/app/context/AppContext\";\nimport ProtectedRoute from \"@/app/components/ProtectedRoute\";\n\nexport default function PregnancyDashboard() {\n  const { token, user } = useAppContext();\n  const [pregnancyData, setPregnancyData] = useState(null);\n  const [error, setError] = useState(\"\");\n\n  useEffect(() => {\n    const fetchPregnancyData = async () => {\n      try {\n        const res = await fetch(\n          `http://localhost:8080/api/pregnancy-checkups/user/${user.id}`,\n          {\n            headers: { Authorization: `Bearer ${token}` },\n          }\n        );\n        if (res.ok) {\n          const data = await res.json();\n          // Aggregate data into the expected format\n          const checkups = data || [];\n          const latestCheckup =\n            checkups.length > 0 ? checkups[checkups.length - 1] : null;\n          setPregnancyData({\n            estimatedDueDate: latestCheckup?.date\n              ? new Date(latestCheckup.date).setDate(\n                  new Date(latestCheckup.date).getDate() + 40 * 7\n                )\n              : null, // Rough estimate\n            appointments: checkups,\n            weight: latestCheckup?.weight || null,\n            bloodPressure: latestCheckup?.bloodPressure || null,\n          });\n        } else {\n          setError(\"No pregnancy data available\");\n        }\n      } catch {\n        setError(\"Something went wrong\");\n      }\n    };\n    if (token && user?.id) fetchPregnancyData();\n  }, [token, user?.id]);\n\n  if (error) return <div className=\"p-6 text-red-500 text-center\">{error}</div>;\n  if (!pregnancyData) return <div className=\"p-6 text-center\">Loading...</div>;\n\n  const { estimatedDueDate, appointments, weight, bloodPressure } =\n    pregnancyData;\n\n  return (\n    <ProtectedRoute allowedRoles={[\"user\", \"doctor\", \"admin\"]}>\n      <div className=\"p-6 max-w-4xl mx-auto\">\n        <h1 className=\"text-2xl font-semibold mb-4\">Pregnancy Dashboard</h1>\n        <div className=\"bg-background p-6 rounded-lg shadow-md\">\n          <div className=\"mb-6\">\n            <h2 className=\"text-lg font-medium mb-2 text-foreground\">\n              Overview\n            </h2>\n            <p className=\"text-foreground\">\n              <strong>Estimated Due Date:</strong>{\" \"}\n              {estimatedDueDate\n                ? new Date(estimatedDueDate).toLocaleDateString()\n                : \"Not estimated\"}\n            </p>\n            <p className=\"text-foreground\">\n              <strong>Current Week:</strong>{\" \"}\n              {estimatedDueDate\n                ? Math.floor(\n                    (((new Date() - new Date(estimatedDueDate)) /\n                      (7 * 24 * 60 * 60 * 1000)) *\n                      -1) /\n                      7\n                  ) + \" weeks\"\n                : \"N/A\"}\n            </p>\n          </div>\n          <div className=\"mb-6\">\n            <h2 className=\"text-lg font-medium mb-2 text-foreground\">\n              Health Metrics\n            </h2>\n            <p className=\"text-foreground\">\n              <strong>Weight:</strong> {weight || \"Not recorded\"} kg\n            </p>\n            <p className=\"text-foreground\">\n              <strong>Blood Pressure:</strong> {bloodPressure || \"Not recorded\"}{\" \"}\n              mmHg\n            </p>\n          </div>\n          <div>\n            <h2 className=\"text-lg font-medium mb-2 text-foreground\">\n              Appointments\n            </h2>\n            <ul className=\"space-y-2\">\n              {appointments?.length > 0 ? (\n                appointments.map((appt, index) => (\n                  <li key={index} className=\"text-foreground\">\n                    {new Date(appt.date).toLocaleString()} - {appt.details}\n                  </li>\n                ))\n              ) : (\n                <p className=\"text-foreground/80\">No appointments scheduled.</p>\n              )}\n            </ul>\n          </div>\n        </div>\n      </div>\n    </ProtectedRoute>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}