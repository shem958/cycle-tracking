{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/shercy/cycle-tracking/src/app/register/page.js"],"sourcesContent":["\"use client\";\nimport { createContext, useContext, useState, useEffect } from \"react\";\nimport { jwtDecode } from \"jwt-decode\";\n\n// Create the context\nconst AppContext = createContext();\n\n// Context provider component\nexport const AppProvider = ({ children }) => {\n  const [user, setUser] = useState(null); // Store logged-in user\n  const [token, setToken] = useState(null); // Auth token\n  const [cycles, setCycles] = useState([]);\n  const [moods, setMoods] = useState([]);\n  const [symptoms, setSymptoms] = useState([]);\n  const [loading, setLoading] = useState(false);\n\n  // Load token and user on app mount\n  useEffect(() => {\n    const savedToken = localStorage.getItem(\"token\");\n    if (savedToken) {\n      try {\n        const decoded = jwtDecode(savedToken);\n        setToken(savedToken);\n        setUser({\n          id: decoded.id,\n          username: decoded.username,\n          role: decoded.role,\n        });\n        fetchUser(savedToken);\n      } catch {\n        setToken(null);\n        localStorage.removeItem(\"token\");\n      }\n    }\n  }, []);\n\n  const fetchUser = async (authToken) => {\n    try {\n      const res = await fetch(\"http://localhost:8080/api/profile\", {\n        headers: { Authorization: `Bearer ${authToken}` },\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setUser((prev) => ({ ...prev, ...data }));\n      } else {\n        setToken(null);\n        localStorage.removeItem(\"token\");\n      }\n    } catch (err) {\n      console.error(\"Failed to fetch user:\", err);\n    }\n  };\n\n  // Fetch cycles from backend\n  const fetchCycles = async () => {\n    if (!token) return;\n    setLoading(true);\n    try {\n      const res = await fetch(\"http://localhost:8080/api/cycles\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (res.ok) {\n        const data = await res.json();\n        setCycles(data);\n      }\n    } catch (err) {\n      console.error(\"Failed to fetch cycles:\", err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const logout = () => {\n    setUser(null);\n    setToken(null);\n    setCycles([]);\n    localStorage.removeItem(\"token\");\n  };\n\n  return (\n    <AppContext.Provider\n      value={{\n        user,\n        setUser,\n        token,\n        setToken,\n        cycles,\n        setCycles,\n        moods,\n        setMoods,\n        symptoms,\n        setSymptoms,\n        loading,\n        fetchCycles,\n        logout,\n      }}\n    >\n      {children}\n    </AppContext.Provider>\n  );\n};\n\n// Custom hook for easy access\nexport const useAppContext = () => useContext(AppContext);\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAIA,qBAAqB;AACrB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,gBAAa,AAAD;AAGxB,MAAM,cAAc,CAAC,EAAE,QAAQ,EAAE;IACtC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,OAAO,uBAAuB;IAC/D,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,OAAO,aAAa;IACvD,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IAC3C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,mCAAmC;IACnC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,IAAI,YAAY;YACd,IAAI;gBACF,MAAM,UAAU,CAAA,GAAA,sJAAA,CAAA,YAAS,AAAD,EAAE;gBAC1B,SAAS;gBACT,QAAQ;oBACN,IAAI,QAAQ,EAAE;oBACd,UAAU,QAAQ,QAAQ;oBAC1B,MAAM,QAAQ,IAAI;gBACpB;gBACA,UAAU;YACZ,EAAE,OAAM;gBACN,SAAS;gBACT,aAAa,UAAU,CAAC;YAC1B;QACF;IACF,GAAG,EAAE;IAEL,MAAM,YAAY,OAAO;QACvB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,qCAAqC;gBAC3D,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,WAAW;gBAAC;YAClD;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,QAAQ,CAAC,OAAS,CAAC;wBAAE,GAAG,IAAI;wBAAE,GAAG,IAAI;oBAAC,CAAC;YACzC,OAAO;gBACL,SAAS;gBACT,aAAa,UAAU,CAAC;YAC1B;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;QACzC;IACF;IAEA,4BAA4B;IAC5B,MAAM,cAAc;QAClB,IAAI,CAAC,OAAO;QACZ,WAAW;QACX,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,oCAAoC;gBAC1D,SAAS;oBAAE,eAAe,CAAC,OAAO,EAAE,OAAO;gBAAC;YAC9C;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,UAAU;YACZ;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,2BAA2B;QAC3C,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,SAAS;QACb,QAAQ;QACR,SAAS;QACT,UAAU,EAAE;QACZ,aAAa,UAAU,CAAC;IAC1B;IAEA,qBACE,8OAAC,WAAW,QAAQ;QAClB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;AAGO,MAAM,gBAAgB,IAAM,CAAA,GAAA,qMAAA,CAAA,aAAU,AAAD,EAAE","debugId":null}}]
}