{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/shercy/cycle-tracking/src/app/components/ProtectedRoute.js"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAppContext } from \"../context/AppContext\";\n\nexport default function ProtectedRoute({ children, allowedRoles }) {\n  const { user, token, isTokenExpired } = useAppContext();\n  const router = useRouter();\n  const [isLoading, setIsLoading] = useState(true);\n  const [isAuthorized, setIsAuthorized] = useState(false);\n\n  useEffect(() => {\n    const checkAuth = () => {\n      // No token means not authenticated\n      if (!token || isTokenExpired(token)) {\n        setIsAuthorized(false);\n        setIsLoading(false);\n        router.push(\"/login\");\n        return;\n      }\n\n      // Check role authorization if roles are specified\n      if (allowedRoles && user) {\n        if (!allowedRoles.includes(user.role)) {\n          setIsAuthorized(false);\n          setIsLoading(false);\n          router.push(\"/\"); // Redirect to home if role not allowed\n          return;\n        }\n      }\n\n      // If we have token and user passes role check\n      if (user) {\n        setIsAuthorized(true);\n        setIsLoading(false);\n      } else {\n        // Wait a bit more for user data to load\n        setTimeout(() => {\n          if (!user) {\n            setIsAuthorized(false);\n            setIsLoading(false);\n            router.push(\"/login\");\n          }\n        }, 1000);\n      }\n    };\n\n    checkAuth();\n  }, [token, user, allowedRoles, router, isTokenExpired]);\n\n  // Show loading spinner while checking authentication\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto\"></div>\n          <p className=\"mt-4 text-foreground/70\">Checking authentication...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Don't render children if not authorized\n  if (!isAuthorized) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-semibold text-foreground mb-2\">\n            Access Denied\n          </h2>\n          <p className=\"text-foreground/70\">\n            You don&apos;t have permission to access this page.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return children;\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;;;AAHA;;;;AAKe,SAAS,eAAe,EAAE,QAAQ,EAAE,YAAY,EAAE;;IAC/D,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,cAAc,EAAE,GAAG,CAAA,GAAA,sIAAA,CAAA,gBAAa,AAAD;IACpD,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,MAAM;sDAAY;oBAChB,mCAAmC;oBACnC,IAAI,CAAC,SAAS,eAAe,QAAQ;wBACnC,gBAAgB;wBAChB,aAAa;wBACb,OAAO,IAAI,CAAC;wBACZ;oBACF;oBAEA,kDAAkD;oBAClD,IAAI,gBAAgB,MAAM;wBACxB,IAAI,CAAC,aAAa,QAAQ,CAAC,KAAK,IAAI,GAAG;4BACrC,gBAAgB;4BAChB,aAAa;4BACb,OAAO,IAAI,CAAC,MAAM,uCAAuC;4BACzD;wBACF;oBACF;oBAEA,8CAA8C;oBAC9C,IAAI,MAAM;wBACR,gBAAgB;wBAChB,aAAa;oBACf,OAAO;wBACL,wCAAwC;wBACxC;kEAAW;gCACT,IAAI,CAAC,MAAM;oCACT,gBAAgB;oCAChB,aAAa;oCACb,OAAO,IAAI,CAAC;gCACd;4BACF;iEAAG;oBACL;gBACF;;YAEA;QACF;mCAAG;QAAC;QAAO;QAAM;QAAc;QAAQ;KAAe;IAEtD,qDAAqD;IACrD,IAAI,WAAW;QACb,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAE,WAAU;kCAA0B;;;;;;;;;;;;;;;;;IAI/C;IAEA,0CAA0C;IAC1C,IAAI,CAAC,cAAc;QACjB,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAA8C;;;;;;kCAG5D,6LAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;;;;;;IAM1C;IAEA,OAAO;AACT;GA1EwB;;QACkB,sIAAA,CAAA,gBAAa;QACtC,qIAAA,CAAA,YAAS;;;KAFF","debugId":null}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///home/shercy/cycle-tracking/src/app/community/page.js"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { useAppContext } from \"@/app/context/AppContext\";\nimport ProtectedRoute from \"@/app/components/ProtectedRoute\";\n\nexport default function CommunityFeed() {\n  const { token } = useAppContext();\n  const [posts, setPosts] = useState([]);\n  const [error, setError] = useState(\"\");\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      try {\n        const res = await fetch(\"http://localhost:8080/api/community/posts\", {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        if (res.ok) {\n          const data = await res.json();\n          setPosts(data);\n        } else {\n          setError(\"No posts available\");\n        }\n      } catch {\n        setError(\"Something went wrong\");\n      }\n    };\n    if (token) fetchPosts();\n  }, [token]);\n\n  if (error) return <div className=\"p-6 text-red-500 text-center\">{error}</div>;\n  if (!posts.length) return <div className=\"p-6 text-center\">Loading...</div>;\n\n  return (\n    <ProtectedRoute allowedRoles={[\"user\", \"doctor\", \"admin\"]}>\n      <div className=\"p-6 max-w-4xl mx-auto\">\n        <h1 className=\"text-2xl font-semibold mb-4\">Community Feed</h1>\n        <div className=\"bg-background p-6 rounded-lg shadow-md\">\n          <ul className=\"space-y-4\">\n            {posts.map((post) => (\n              <li key={post.id} className=\"p-4 rounded-lg bg-accent/10\">\n                <div className=\"text-foreground\">\n                  <strong>{post.title}</strong> - {post.content}\n                  <p className=\"text-sm text-foreground/70\">\n                    {new Date(post.date).toLocaleString()}\n                  </p>\n                </div>\n              </li>\n            ))}\n          </ul>\n        </div>\n      </div>\n    </ProtectedRoute>\n  );\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;;;AAHA;;;;AAKe,SAAS;;IACtB,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,sIAAA,CAAA,gBAAa,AAAD;IAC9B,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IACrC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEnC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;mCAAE;YACR,MAAM;sDAAa;oBACjB,IAAI;wBACF,MAAM,MAAM,MAAM,MAAM,6CAA6C;4BACnE,SAAS;gCAAE,eAAe,CAAC,OAAO,EAAE,OAAO;4BAAC;wBAC9C;wBACA,IAAI,IAAI,EAAE,EAAE;4BACV,MAAM,OAAO,MAAM,IAAI,IAAI;4BAC3B,SAAS;wBACX,OAAO;4BACL,SAAS;wBACX;oBACF,EAAE,OAAM;wBACN,SAAS;oBACX;gBACF;;YACA,IAAI,OAAO;QACb;kCAAG;QAAC;KAAM;IAEV,IAAI,OAAO,qBAAO,6LAAC;QAAI,WAAU;kBAAgC;;;;;;IACjE,IAAI,CAAC,MAAM,MAAM,EAAE,qBAAO,6LAAC;QAAI,WAAU;kBAAkB;;;;;;IAE3D,qBACE,6LAAC,6IAAA,CAAA,UAAc;QAAC,cAAc;YAAC;YAAQ;YAAU;SAAQ;kBACvD,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAA8B;;;;;;8BAC5C,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAG,WAAU;kCACX,MAAM,GAAG,CAAC,CAAC,qBACV,6LAAC;gCAAiB,WAAU;0CAC1B,cAAA,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;sDAAQ,KAAK,KAAK;;;;;;wCAAU;wCAAI,KAAK,OAAO;sDAC7C,6LAAC;4CAAE,WAAU;sDACV,IAAI,KAAK,KAAK,IAAI,EAAE,cAAc;;;;;;;;;;;;+BAJhC,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;AAc9B;GAhDwB;;QACJ,sIAAA,CAAA,gBAAa;;;KADT","debugId":null}}]
}